= Предпросмотр файла

Элемент управления `_Предпросмотр файла_` предназначен для отображения содержимого файла, выбранного в элементе xref:ctrl/special/fileList.adoc[Список файлов], xref:ctrl/special/taskCardFilePanel.adoc[Файловая панель], xref:ctrl/approval/approvalFilePanel.adoc[Файловая панель согласования].

WARNING: Если максимальный размер файла для предпросмотра xref:admin:max-preview-size.adoc[ограничен] настройками системы, вместо предпросмотра больших будет выводиться сообщение об ошибке `Предпросмотр недоступен согласно настройкам системы. Для ознакомления с файлом скачайте его и откройте в соответствующей программе.`

.Пример элемента управления "Предпросмотр файла" в разметке карточки
image::file-preview-sample.png[Пример элемента управления "Предпросмотр файла" в разметке карточки]

.Данный элемент управления позволяет:
* Отображать содержимое файла непосредственно в разметке просмотра и редактирования карточки.
* Отображать содержимое файла при загрузке карточки без необходимости выбора файла.
* Переключаться между отображаемыми файлами.
* Работать с несколькими элементами `_Список файлов_`: если в разметке несколько данных элементов, ЭУ `_Предпросмотр файла_` будет показывать содержимое активного элемента `_Список файлов_`.

.Важные особенности использования элемента "Предпросмотр файла"
****
* В разметку можно добавить только один элемент `_Предпросмотр файла_`.
* Элемент управления `_Предпросмотр файла_` должен быть добавлен в отдельный элемент xref:ctrl/layoutElements/block.adoc[Блок], в котором не должно быть других элементов кроме элемента `_Предпросмотр файла_`.
* Родительский блок элемента `_Предпросмотр файла_` должен размещаться в блоке, содержащем только два дочерних элемента (см. рисунок ниже): блок с элементом `_Предпросмотр файла_` и блок с остальными элементами разметки.
+
.Пример структуры разметки, соответствующей требованиям
image::file-preview-recommendation.png[Пример структуры разметки, соответствующей требованиям]
****

// tag::previewFormats[]
.Типы файлов, для которых поддерживается предварительный просмотр:
* `.pdf`.
* Офисные: `.docx`, `.odt`, `.doc`, `.rtf`, `.dot`, `.dotx`, `.xlt`, `.xls`, `.xltx`, `.xlsx`, `.ods`;
* изображения: `.jpg`, `.jpeg`, `.gif`, `.png`, `.bmp`, `.tiff`, `.tif`, `.emf`, `.wmf`;
* Прочие: `.htm`, `.adoc`, `.js`, `.xslt`, `.xsl`, `.xml`, `.asmx`, `.ascx`, `.aspx`, `.cpp`, `.h`, `.css`, `.idl`, `.ini`, `.java`, `.rc`, `.rc2`, `.shtm`, `.shtml`, `.txt`, `.log`, `.cs`, `.sql`, `.csv`.
// end::previewFormats[]

.Особенности реализации:
****
Файлы с поддержкой предпросмотра транслируются в формат PDF на сервере {wc}, и отображаются на клиенте с использованием компонента https://mozilla.github.io/pdf.js/getting_started/[PDF.JS], который предоставляет пользователям следующие функции:

* Переход между страницами.
* Выбор масштаба.
* Поиск по содержимому (только для текстовых документов).
* Печать и др.

См. информацию по компоненту PDF.JS в сети Интернет.
****

NOTE: Данный элемент управления может быть добавлен в разметки создания, просмотра и редактирования карточек _Документ_, а также *просмотра* и *редактирования* карточек _Задание_ и _Группа заданий_.

WARNING: Работа элемента управления в разметке создания карточек _Задание_ и _Группа заданий_ НЕ поддерживается.

== Свойства

include::partial$properties.adoc[tags=general]

=== Поведение

include::partial$properties.adoc[tags=visibility]

==== Высота (в пикселях)

Устанавливает высоту элемента `_Препросмотр файла_` в пикселях.

include::partial$properties.adoc[tags=addCss]

==== Комментарии

Включает или выключает возможность комментирования файла.

include::partial$properties.adoc[tags=byTab]

[#openFileAtLoad]
==== Раскрывать файл

Включает или выключает режим отображения содержимого файла при загрузке разметки. При выключенном свойстве содержимое файла отображается только после его выбора.

Если элемент `_Список файлов_` содержит несколько файлов, при включенном свойстве `*Раскрывать файл*` будет отображаться первый файл по списку.

include::partial$properties.adoc[tags=stdCss]

==== Ширина по умолчанию (в процентах)

Ширина элемента в процентах относительно родительского элемента.

=== События

==== Перед открытием/сокрытием блока комментариев

Вызывается перед открытием и закрытием блока комментариев.

==== Перед открытием/сокрытием окна

Вызывается перед закрытием окна предпросмотра.

==== Перед скачиванием файла

Вызывается при нажатии кнопки загрузки файла на компьютер.

==== Перед сменой файла

Вызывается перед сменой отображаемого файла.

==== После открытия/сокрытия блока комментариев

Вызывается после открытия и закрытия блока комментариев.

==== После открытия/сокрытия окна

Вызывается после закрытия окна предпросмотра.

==== После скачивания файла

Вызывается после нажатия кнопки загрузки файла на компьютер.

==== После смены файла

Вызывается после смены отображаемого файла.

include::partial$properties.adoc[tags=mouseOver]

include::partial$properties.adoc[tags=mouseAway]

include::partial$properties.adoc[tags=onClick]
