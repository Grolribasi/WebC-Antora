= Использование поиска по карточкам

Для ввода поискового запроса используется <<folderSearch,Поле поиска>>.

Чтобы очистить результаты поиска, нажмите на крестик image:buttons/x.png[Крест] в строке поиска.

Пользователям {wc}а доступны различные варианты поиска карточек.

[#folderSearch]
== Поиск по папке

Поиск по текущей папке используется, если отключен <<fullTextSearch,полнотекстовый>> поиск. В этом случае выполняется поиск карточек открытой папки, в которых встречается указанная строка.

.Поиск по папке
image::search-current-folder.png[Поиск по папке]

Чтобы осуществить поиск по открытой папке, введите в строке поиска один или несколько символов искомого слова. Поиск карточек будет выполнен после непродолжительной паузы. При повторном открытии данной папки будет применен ранее использованный поисковый запрос.

// tag::resetSearch[]
Чтобы сбросить поисковый запрос: нажмите крестик в строке поиска. В качестве альтернативы, вы можете стереть все символы, введённые в строку поиска, и нажать kbd:[Enter] или кнопку *Найти*.

TIP: Текущий поисковый запрос будет также сброшен вместе с пользовательскими xref:folders-general.adoc#reset-user-settings[настройками папки].
// end::resetSearch[]

[#fullTextSearch]
== Полнотекстовый поиск

include::partial$excerpts.adoc[tags=fullTextResults]

Пользователь {wc}а может осуществлять поиск карточек по содержимому с помощью полнотекстового поиска. Полнотекстовый поиск становится доступным при выполнении следующих условий:

* Полнотекстовый поиск настроен в {dv}.
+
Настройка полнотекстового поиска осуществляются по инструкции, приведённой в xref:platform:admin:search-full-text.adoc[документации] модуля {pl}.
+
* Данные карточек проиндексированы.

Полнотекстовый поиск карточек может выполняться среди карточек текущей открытой папки или среди всех карточек. Область поиска выбирается в xref:interface-search.adoc[строке поиска] при соблюдении следующих правил:

* На xref:interface-dashboard.adoc[главной странице] доступен только режим поиска среди всех карточек.
* На странице папки доступны варианты поиска:
- По всем карточкам,
- Карточкам текущей папки,
- Карточкам папки и её подпапок.

.Чтобы осуществить полнотекстовый поиск:
. Введите в строке поиска часть слова или фразу искомого текста.
. Выберите область поиска:
+
В текущей папке::
Область поиска доступна для выбора только на страницах _стандартных_ или _виртуальных_ папок.
+
При выполнении поиска в дочерней папке, поиск в родительской папке выполнен не будет.
+
В поле поиска для данного варианта отображается подсказка: `Искать в текущей папке`.
+
Включая подпапки::
Область поиска доступна для выбора только на страницах _стандартных_ или _виртуальных_ папок, у которых имеются дочерние папки.
+
В поле поиска для данного варианта отображается подсказка: `Искать в текущей папке, включая стандартные подпапки`.
+
.Выбор области поиска
image::search-area.png[Выбор области поиска]
+
В найденном::
Область поиска доступна для выбора в папке _Поиск_ при наличии ранее найденных карточек в данной папке.
+
В поле поиска для данного варианта отображается подсказка: `В найденном`. После поиска в найденном, результаты поиска отображаются как папка с заголовком `Результаты поиска: ... → поисковый-запрос`.
+
Везде::
Область поиска доступна для выбора на всех страницах {wc}а.
+
При выборе данного варианта поиск карточек будет выполняться по всей базе данных.
+
В поле поиска для данного варианта отображается подсказка: `Везде`.
+
Результаты поиска будут отображаться как отдельная папка с представлением _Результаты поиска_. Результаты поиска сохранятся в том же виде, даже после открытия карточки или обновления страницы.
+
. Нажмите клавишу kbd:[Enter] или нажмите кнопку *Найти*, чтобы отправить поисковый запрос на сервер.

.Особенности полнотекстового поиска:
****
* Когда выбрана область поиска *_В текущей папке_*, *_Включая подпапки_*, результаты поиска отображаются как папка с заголовком `Название-текущей-папки (результаты поиска: поисковый-запрос)`.
* Если область поиска *_В текущей папке_*, *_Включая подпапки_* или *_В найденном_* и поисковый запрос был удалён нажатием на крестик image:buttons/x.png[Крест] в строке поиска, строка поиска будет очищена и откроется исходная папка, из которой был запущен поиск.
* В папках с поисковыми запросами доступны xref:grid.adoc[обычные] функции грида, включая xref:grid-batch.adoc[групповые операции].
* Если в папке с применённым поисковым запросом применена xref:grid-group.adoc[группировка] или xref:grid-filter.adoc[фильтрация], кнопка *Показать все*, сбрасывает только фильтрацию или группировку, но не сбрасывает поисковый запрос.
* Поиск в папке с применённым xref:grid-filter.adoc[фильтром] или xref:grid-group.adoc[группировкой], отобразит только карточки, найденные в отфильтрованном или сгруппированном. Счётчик количества карточек будет пересчитан.
* Когда поисковая строка пустая, нажатие на кнопку *Найти* отображает всй содержимое папки.
* Если в настройках полнотекстового поиска не установлены ограничения на типы карточек, будет выполнен поиск по всем типам карточкам, иначе только по разрешенным типам.
* Поисковый запрос, используемый для поиска по текущей папке или папке с подпапками, сохраняется и будет использован при повторном открытии данной папки.
****

include::search.adoc[tags=resetSearch]

Администратор {dv} может настроить полнотекстовый поиск с использованием одной из нескольких систем полнотекстового поиска. В зависимости от системы результаты поиска, а также требования к исходным данным могут отличаться. Например, при поиске с использованием системы Elasticsearch есть следующие особенности:

* Может потребоваться ввод большего числа знаков в словах поисковой фразы.
* Результаты поиска могут содержать записи, которые не полностью соответствуют поисковой фразе.
* В некоторых вариантах поисковой фразы Elasticsearch может не возвращать результаты.

Также от выбора системы полнотекстового поиска зависит возможность поиска по различным типам файлов:

* При использовании встроенной в Microsoft SQL Server системы поиска: `.pdf` и файлы Microsoft Office;
* При использовании системы полнотекстового поиска Elasticsearch: `.pdf`, файлы Microsoft Office (`.docx`, `.doc`, `.xlsx`, `.xls`, `.pptx`, `.ppt`, `.rtf`), `.html` и `.txt`.

TIP: Ознакомится с подробной инструкцией по настройке поисковой системы и особенностями работы каждой из них можно в xref:platform:admin:search-full-text.adoc[документации] модуля {pl}.

[#results]
=== Папка "Результаты поиска"

Если выбрана область поиска *_Везде_*, результаты поиска будут отображаться как отдельная папка _Результаты поиска_. Результаты поиска не исчезают после открытия карточки или обновления страницы.

В результатах поиска доступны xref:grid.adoc[все] функции грида, включая xref:grid-batch.adoc[групповые операции].

Когда применена xref:grid-group.adoc[группировка] или xref:grid-filter.adoc[фильтрация], кнопка *Показать все* возвращает к последнему поисковому запросу.

При включенном фильтре, поиск производится только среди отфильтрованного.

В результатах поиска отображаются только карточки, к которым у текущего пользователя есть доступ.

При отсутствии карточек, удовлетворяющих запросу, в представлении отображается текст: `Нет данных для отображения`.

[#attributive]
== Параметрический (атрибутивный) поиск

Параметрический поиск -- вариант поискового запроса, для выполнения которого пользователь должен предварительно настроить параметры запроса с помощью предоставляемой панели настройки.

.Панель настройки параметрического поиска
image::parametric-search.png[Панель настройки параметрического поиска]

[horizontal]
.Панель настройки параметрического поиска содержит:
Список параметров запроса::
+
Значение параметра устанавливается с помощью элемента управления, соответствующего типу параметра.
+
При наведении курсора мыши на название параметра будет отображена подсказка с условием поиска по данному параметру.
+
Переключатели использования параметра в запросе::
* image:buttons/switch-on.png[Вкл.] -- параметр используется в запросе.
* image:buttons/switch-off.png[Выкл.] -- параметр не используется в запросе.
+
Ссылки::
* Очистить все. Очищает значения всех параметров и устанавливает все переключатели в значение *Не используется*.
* Включить все. Устанавливает все переключатели в значение *Используется*.
* Последний поиск. Устанавливает параметры и переключатели в значения, которые были использованы при последнем выполнении данного запроса на данном устройстве.
. Кнопка *Закрыть*. Закрывает панель настройки.
. Кнопка *ОК*. Выполняет запрос.
+
Выполнить поисковой запрос можно также нажатием на клавиатуре t кнопки kbd:[Enter]. Если при этом какое-либо поле находится в режиме выбора, например выбор даты и выбор из справочника, при первом нажатии будет выполнен выбор.

.Чтобы настроить и выполнить параметрический запрос:
. Раскройте в основном меню папку _Договоры_ и выберите пункт _Поиск_.
. Введите или выберите значения параметров, которые должны быть добавлены в поисковый запрос.
+
При изменении значения параметра, переключатель использования будет автоматически включен.
+
Если значение параметра, включенного в запрос, не выбрано, он будет участвовать в запросе с признаком `*значение поля не указано`*.
. Установить переключатели использования параметров, которые не должны использоваться в запросе, в значениеimage:buttons/switch-off.png[Выкл.].
. Нажать на кнопку *ОК*.

[#barcode-search]
== Поиск карточки по штрих-коду

.Чтобы открыть карточку, зная её штрих код:
. Откройте поле для ввода нажатием кнопки image:buttons/search-barcode.png[Поиск по штрихкоду] на панели меню.
+
.Кнопка и поле для ввода штрих-кода
image::search-bardcode.png[Кнопка и поле для ввода штрих-кода]
+
. Введите в текстовое поле цифровое значение штрих-кода с помощью клавиатуры или сканера штрих-кодов.
+
****
Найденная карточка будет открыта в новой вкладке веб-браузера.

Если карточка с указанным штрих-кодом не зарегистрирована в {dv}, будет выдано сообщение: `Не удалось найти карточку с указанным штрихкодом`. Повторите поиск с корректным значением штрих-кода.
****

[#batch-barcode-search]
=== Потоковый поиск карточек по штрих-коду

Помимо одиночного режима поиска карточки по штрих-коду, {wc} поддерживает потоковый режим, при котором пользователь может открыть одновременно несколько карточек, предварительно указав их штрих-коды. Данный режим поиска должен быть xref:layouts:ctrl/webFrame/barcodeSearchButton.adoc#barCodeMode[настроен] отдельно.

.Чтобы выполнить поиск нескольких карточек:
. Откройте поле для ввода нажатием кнопки image:buttons/search-barcode.png[Поиск по штрихкоду] на панели меню.
. Введите в текстовое поле цифровое значение штрих-кода с помощью клавиатуры или сканера штрих-кодов.
+
****
В правой части поля поиска появится кнопка открытия карточек, в которой будет указано количество штрих-кодов в очереди поиска.
****
+
.Поле ввода штрих-кода с кнопкой открытия карточек
image::search-bardcode-multi-mode.png[Поле ввода штрих-кода с кнопкой открытия карточек]
+
. Последовательно введите штрих-коды других искомых карточек.
. Нажмите на кнопку *Открыть карточек: <Кол-во карточек>*.
+
****
В веб-браузере будут открыты вкладки с найденными карточками.
****
+
. Если карточка с указанным штрих-кодом не зарегистрирована в {dv}, она будет содержать текст: `Не удалось найти карточку с указанным штрихкодом`.
+
****
Повторите поиск с корректным значением штрих-кода.
****
+
[NOTE]
====
Технические возможности ограничивают максимальное число вкладок, которые могут быть одновременно открыты в веб-браузере. Если при выполнении потокового поиска возникла ошибка вида `К сожалению, произошла ошибка. Пожалуйста, обратитесь к администратору системы... Не удалось завершить действие` попробуйте выполнить поиск меньшего числа карточек.
====
+
.Кнопка *X* в поле ввода штрих-кода очищает:
* Текущее значение в строке, если оно введено.
* Очередь поиска, если строка поиска пуста.
